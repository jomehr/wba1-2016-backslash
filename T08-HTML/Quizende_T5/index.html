<!DOCTYPE html>
<html>
	<head>
		<title>Schlussscreen</title>
		<link rel="stylesheet" href="./css/style.css">
		<link rel="stylesheet" href="./T09-CSS/style.css">
		<meta name="viewport" content="width=device-width, initial-scale=1">
	</head>
	<body style="background: lightgrey; max-width: 1000px; margin: 0 auto;">
		<div class="ss_box">
			<header class="bg-yellow">
				<h1 id="JS_Titel">Effzeh - mer wesse alles üvver dich</h1>
			</header>
			<div class="ss_erg ss_box_content row">
				<div class="ss_left col-md-8 col-xs-12">
					<h2 style="margin-top: 0px;">Dein Ergebnis</h2>
					<div class="ss_score row">
						<div class="ss_score_sp col-md-7 col-xs-12">
							<p class="ss_mobile_points_txt"></p>
							<div class="ss_score_balken bg-mediumgrey">
								<div class="ss_scale_score" id="JS_ScaleScore" style="width: 10%;">
								</div>
							</div>
							<p class="ss_mobile_answer_txt"></p>
							<div class="ss_score_points" id="JS_Score">
							</div>
						</div>

						<div class="ss_score_txt col-md-5">
							<p id=JS_punkte> </p>
							<p id=JS_richtig> </p>
						</div>
					</div>
					<p>Ich will mehr zu diesem Thema wissen</p>
					<div class="ss_scoreboard">
						<p>Neue Position</p>
						<div id=highscore_handlebars>
						</div>
					</div>
				</div>
				<div class="ss_right col-md-4 col-xs-12">
					<figure>
						<img src="img/Fan1.jpg" alt="Fan1.jpg" class="img-responsive" id="JS_Bild"/>
						<figcaption>
							<p id="JS_Text">Das FC-Quizz schlecht hin. Der wahre FC Fan
							beantwortet diese Fragen im Schlaf. Dabei
							handelt es sich nicht nur um Fragen zur
							Fußballerischen Geschichte des Vereins,
							denn der FC hat auch außerhalb des Platzes
							eine große Geschichte. Mit diesem Quizz
							kannst du dein Wissen über den besten
							Verein der Welt testen. Los  geht's!</p>
						</figcaption>
					</figure>
				</div>
			</div>
			<div class="ss_buttons ss_box_content row">
				<div class="col-md-4">
					<input type="button" value="Übersicht" />
				</div>
				<div class="col-md-4">
					<input type="button" value="Highscoreliste" />
				</div>
				<div class="col-md-4">
					<input type="button" value="Jetzt spielen!" />
				</div>
			</div>
		</div>
		<div class="ss_box">
			<h2 style="text-align: center; padding-top: 24px;">Das könnte dir auch gefallen</h2>
			<div class="ss_slider_content row">
				<div class="col-md-4">
					<h2 id="JS_Vorschlag1_Titel">Das Stadion Quizz</h2>
					<img class="img-responsive" src="img/Stadion10.jpg" alt="Stadion10.jpg" id="JS_Vorschlag1_Bild" />
				</div>
				<div class="col-md-6 ss_slider_text">
					<p id="JS_Vorschlag1_Text">Die größten, bedeutendsten, modernsten und
					wichtigsten Stadien der Welt. Kaum etwas ist
					bei großen Vereinen so bedeutend wie das
					Stadion. Es ist nicht nur ein Statussymbol für
					jeden erfolgreichen Verein, sondern oft auch
					ein Denkmal für große Ereignisse in der
					Historie eines Vereins. Hier findest Fragen
					zu den Stadien der Welt. Auf geht's!</p>
					<div class="ss_slider_author font-bold" id="JS_Vorschlag1_DateUser">
						17.06.2016<br />
						Hennes48
					</div>
				</div>
				<div class="col-md-2 ss_slider_right">
					<p><span class="font-bold" id="JS_Vorschlag1_Played">67</span> mal gespielt</p>
					<div class="ss_slider_points fg-white bg-darkgrey font-bold">8 / 10 Punkten</div>
					<input type="button" value="Jetzt spielen!" />
				</div>
			</div>
			<div class="ss_slider_menu">
				<div class="ss_slider_menu_elemente">
					<div class="ss_slider_menu_left font-bold">&lt;</div>
					<div class="ss_slider_bt "></div>
					<div class="ss_slider_bt"></div>
					<div class="ss_slider_bt"></div>
					<div class="ss_slider_menu_right font-bold">&gt;</div>
				</div>
			</div>
		</div>
		<script type="text/javascript" src="js/script.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/handlebars.js/1.1.2/handlebars.min.js"></script><!-- online handlebars.js-->
		<script src="https://rawgit.com/th-koeln/wba1-2016-backslash/master/T13-Datenstruktur_Content/API/BS_API.js"></script>

		<!-- highscore template
		-->

		<script id="highscore-template" type="text/x-handlebars-template">
			<table class="font-bold table">
					{{#each highscore}}
						<tr>
							<td>{{this.position}}</td>
							<td>{{this.name}}</td>
							<td>{{this.punktzahl}} Punkte</td>
						</tr>
					{{/each}}
			</table>
		</script>

		<!--
		Highscore fill Funktion & Quiz Info
		-->
		<script type="text/javascript">
			sessionStorage.setItem('quizid', 1);
			var quizID = sessionStorage.getItem('quizid');

			$(function() {
				getHighscoreByID(quizID);
				$(document).on( "onHighscoreData", function( event, data ) {
					var HighscoreJson=JSON.parse(data);
					//Slice für top5
				 	HighscoreJson.highscore=HighscoreJson.highscore.slice(0,5);
					var source =$("#highscore-template").html();
					var template = Handlebars.compile(source);
					$('#highscore_handlebars').append(template(HighscoreJson));
				});

			//QUIZ info

				getQuizViewByID(quizID);
				$(document).on( "onQuizViewByID", function( event, data ) {
					var quizInfo=JSON.parse(data);
					document.getElementById("JS_Bild").src=quizInfo.bild;
					document.getElementById("JS_Text").innerHTML=quizInfo.text;
					document.getElementById("JS_Titel").innerHTML=quizInfo.titel;
				});


			//Random Quiz Vorschlag
				getQuizView(5);
				$(document).on( "onQuizView", function( event, data ) {
					var quizInfo=JSON.parse(data);
					console.log(quizInfo.length);
					var icount=0;
					//RAND Quiz außer aufgerufene Quiz.
					for(var i=0;icount<1;i++) {
						var iRand=Math.random();
						var iRand=Math.round(iRand*quizInfo.length);
						if(iRand!==0){
							iRand--;
						}
						if(quizInfo[iRand].quizID!==quizID) { // <- Abfrage ob QuizID == Random ID ist wenn true neu generieren
							icount++;
							document.getElementById("JS_Vorschlag"+icount+"_Bild").src=quizInfo[iRand].bild;
							document.getElementById("JS_Vorschlag"+icount+"_Text").innerHTML=quizInfo[iRand].text;
							document.getElementById("JS_Vorschlag"+icount+"_Titel").innerHTML=quizInfo[iRand].titel;
							document.getElementById("JS_Vorschlag"+icount+"_DateUser").innerHTML=quizInfo[iRand].datum+" <br />"+quizInfo[icount].autor;
							document.getElementById("JS_Vorschlag"+icount+"_Played").innerHTML=quizInfo[iRand].spielzahl;
						}
					}

				});

			/*
					BITTE BEACHTEN!
					SOLANG DAS QUIZ nicht fertig ist bitte die Variablen Selbst setzen!
					sessionStorage.setItem('maxpoints', '1000');
					sessionStorage.setItem('amountquestions', '10');
					sessionStorage.setItem('correctanswers', '5');
					sessionStorage.setItem('points', '500');
			*/

			//Userdaten rand generieren solange keine bestehen!!!
			var rand1=Math.random(); //Punkte
			var rand2=0; //maxPunkte
			var rand3=Math.random(); //richtige antworten
			var rand4=10; //anzahl Fragen
			rand1=Math.round(1000*rand1);
			while(rand2<=rand1) {
				rand2=Math.random();
				rand2=Math.round(1000*rand2);
			}
			rand3=Math.round(10*rand3);
			sessionStorage.setItem('points', rand1);
			sessionStorage.setItem('maxpoints', rand2);
			sessionStorage.setItem('correctanswers', rand3);
			sessionStorage.setItem('amountquestions', rand4);

			//Hier kommen die User Quiz Data
			var points = sessionStorage.getItem('points');
			var maxpoints = sessionStorage.getItem('maxpoints');
			var countright = sessionStorage.getItem('correctanswers');
			var countquestions = sessionStorage.getItem('amountquestions');

			// Fill Highscore User Data
			var item = document.getElementById('JS_richtig');
			item.innerHTML = countright+" von "+countquestions+" Fragen Richtig";
			item = document.getElementById('JS_punkte');
			item.innerHTML = points+" von "+maxpoints+" Punkten";

			//Scalebar aktualisieren
			var percent=Math.round((points/maxpoints)*100);
    	document.getElementById("JS_ScaleScore").style.width=percent+"%";

			//Red/Green Icons füllen
			item = document.getElementById('JS_Score');
			var redicon = '<div class="ss_score_point bg-red" ></div>';
			var greenicon = '<div class="ss_score_point bg-green" ></div>';
			var length=countquestions;
			for(var i=0;i<length;i++) {
				var random=Math.random();
				if(random >=0.5) {
					item.innerHTML += redicon;
				} else {
					item.innerHTML += greenicon;
				}
			}
		});
		</script>
	</body>
</html>
